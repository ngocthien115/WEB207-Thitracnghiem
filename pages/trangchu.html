<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thi trắc nghiệm - FPT Polytechnic</title>
<!-- File css tất cả các trang-->
    <link rel="stylesheet" href="../css/trangchu.css">
    <link rel="stylesheet" href="../css/hoso.css">
    <link rel="stylesheet" href="../css/quenmatkhau.css">
    <!--file bổ sung-->
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <script src="../js/jquery-3.3.1.min.js"></script>
    <script src="../js/bootstrap.bundle.min.js"></script>
	  <script src="../js/angular.min.js"></script>
	  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
</head>
<body ng-app="myApp">
    <header class="header">
        <nav class="navbar navbar-expand-lg fixed-top py-3">
            <div ng-controller="checkDN" class="container"><a href="#!home" class="navbar-brand text-uppercase font-weight-bold">FPT Polytechnic</a>
                <button type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler navbar-toggler-right"><i class="fa fa-bars"></i></button>
                <div id="navbarSupportedContent" class="collapse navbar-collapse">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item active"><a href="#!home" class="nav-link text-uppercase font-weight-bold">Trang chủ <span class="sr-only">(current)</span></a></li>
                        <li class="nav-item"><a href="#!gioithieu" class="nav-link text-uppercase font-weight-bold">Giới thiệu</a></li>
                        <li class="nav-item"><a href="#!lienhe" class="nav-link text-uppercase font-weight-bold">Liên hệ</a></li>
                        <li class="nav-item"><a href="https://docs.google.com/forms/d/e/1FAIpQLSd4nAJAwpZOEtcRmhDWlDejExSokAbDSIoKlyVGQgRmd5giVQ/viewform?usp=sf_link" target="_blank" class="nav-link text-uppercase font-weight-bold">Góp ý</a></li>
                        <li class="nav-item"><a href="#!hoidap" class="nav-link text-uppercase font-weight-bold">Hỏi đáp</a></li>
                        <li ng-hide="trangthai" class="nav-item"><a href="#!dangnhap" class="nav-link text-uppercase font-weight-bold">Đăng nhập/Đăng kí</a></li>
                        <li ng-show="trangthai" class="nav-item"><a href="#!hoso" ng-bind="tenDN" class="nav-link text-uppercase font-weight-bold"></a></li>
                        
                    </ul>
                </div>
            </div>
        </nav>
        <div class="row">
            <img width="100%" src="../images/banner1.png" alt="">
        </div>
    </header>
    <div class="container p-3">
        <div class="row">
            <article class="col-sm-9" ng-view> </article>
            <aside class="col-sm-3 m-0 p-0">
                <div class="card bg-info mb-3">
                    <div class="card-header text-white" ><i class="fas fa-list"></i> DANH MỤC</div>
                      <ul class="list-group list-group-flush" ng-controller="Danhmuc">
                        <li ng-repeat="mh in cacmonhoc|orderBy:'Name'" class="list-group-item"><a href="#!trangthi/{{mh.Id}}/{{mh.Name}}">{{mh.Name|uppercase}}</a></li>
                      </ul>
                  </div>
            </aside>
        </div>
    </div>
    <footer class="container-fluid site-footer">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 col-md-6">
            <h6>Giới thiệu</h6>
            <p class="text-justify">FPT Polytechnic là trang web của trường Cao Đẳng FPT Polytechnic - là nơi các sinh viên làm bài tập online. Có đầy đủ các khóa học miễn phí dành cho những sinh viên bên ngoài giúp họ có thể tiếp cân được nền giáo dục tiên tiến và nhanh chóng.</p>
          </div>

          <div class="col-xs-6 col-md-3">
            
          </div>

          <div class="col-xs-6 col-md-3">
            <h6>Quick Links</h6>
            <ul class="footer-links">
              <li><a href="#!home">Trang chủ</a></li>
              <li><a href="#!lienhe">Liên hệ</a></li>
              <li><a href="#!hoidap">Hỏi đáp</a></li>
              <li><a href="#!gioithieu">Giới thiệu</a></li>
            </ul>
          </div>
        </div>
        <hr>
      </div>
      <div class="container">
        <div class="row">
          <div class="col-md-8 col-sm-6 col-xs-12">
            <p class="copyright-text">Copyright &copy; 2021 All Rights Reserved by 
          <a href="#">...</a>.
            </p>
          </div>

          <div class="col-md-4 col-sm-6 col-xs-12">
            <ul class="social-icons">
              <li><a class="facebook" href="#"><i class="fab fa-facebook"></i></a></li>
              <li><a class="twitter" href="#"><i class="fab fa-twitter"></i></a></li>
              <li><a class="dribbble" href="#"><i class="fab fa-dribbble"></i></a></li>
              <li><a class="linkedin" href="#"><i class="fab fa-linkedin"></i></a></li>   
            </ul>
          </div>
        </div>
      </div>
    </footer>
</body>
<script src="../js/angular-route.min.js"></script>
<script src="../js/trangchu.js"></script>
<script src="../js/Subjects.js"></script>
<script src="../js/Students.js"></script>
<script>
  var app = angular.module("myApp", ["ngRoute"]);
  app.config(function($routeProvider){
        $routeProvider
        .when("/gioithieu", {templateUrl:"gioithieu.html"})
        .when("/lienhe", {templateUrl:"lienhe.html"})
        .when("/dangnhap", {templateUrl:"dangnhap.html", controller:"frmDn"})
        .when("/hoidap", {templateUrl:"hoidap.html"})
        .when("/hoso", {templateUrl:"hoso.html", controller:"checkDN"})
        .when("/trangthi/:idMH/:idTenMH", {templateUrl:"trangthi.html", controller:"trangthi"})
        .when("/home", {templateUrl:"danhmuc.html", controller:"Danhmuc"})
        .when("/quenmatkhau", {templateUrl:"quenmatkhau.html", controller:"quenmatkhau"})
        .when("/doimatkhau", {templateUrl:"doimatkhau.html", controller:"doimatkhau"})
        .otherwise({templateUrl:"danhmuc.html", controller:"Danhmuc"})
  });
  
  app.controller("frmDn", function($scope, $rootScope){
    $scope.dn = function(){
      var u = $scope.username;
      var p = $scope.pwd;
      var tc = false;
      var motsv;
      for(var i = 0; i < students.length; i++){
        motsv = students[i];
        if(u == motsv.username && p == motsv.password){
          tc = true;
          break;
        }
      }
      if(tc){
        sessionStorage.setItem("username", motsv.username);
        sessionStorage.setItem("hoten", motsv.fullname);
        sessionStorage.setItem("email", motsv.email);
        sessionStorage.setItem("birthday", motsv.birthday);
        document.location = "trangchu.html";
      }
      else {
        Swal.fire({
          icon: 'error',
          title: 'Oops...',
          text: 'Sai tài khoản hoặc mật khẩu!!'
        })
      }
    }
  })

  app.controller("Danhmuc", function($scope, $http, $routeParams){
    $scope.cacmonhoc = [];
    $scope.idMH = $routeParams.idMH;
    $scope.tenMH = $routeParams.tenMH;
    $http.get("../js/Subjects1.js").then(function(d){
      $scope.cacmonhoc = d.data;
    })
    $scope.start = 0;
    $scope.tiep = function(){
      $scope.start += 4;
    }
    $scope.truoc = function(){
      $scope.start -= 4;
    }
  })

  app.controller("trangthi", function($scope, $http, $routeParams){
    $scope.caccauhoi = [];
    $scope.idMH = $routeParams.idMH;
    $scope.tenMH = $routeParams.tenMH;
    $http.get("../js/Quizs/" + $scope.idMH + ".js").then(
      function(d) {$scope.caccauhoi = d.data; },
      function(d) {alert("Lỗi !!");}
    );
    $scope.begin = 0;
    $scope.dautien = function(){
      $scope.begin = 0;
    }
    $scope.truoc = function(){
      
      $scope.begin -= 1;
    }
    $scope.sau = function(){
      $scope.begin += 1;
    }
    $scope.cuoi = function(){
      $scope.begin = -1
    }
    $scope.mark = 0;
    var checkTraLoi = $scope.traLoi = {checked: ""};
    $scope.submit = function(){
      var a =  $("#cauTraLoi").val();
      var b =  $("#dapAn").val();
      if(parseInt(a) == parseInt(b)){
        Swal.fire({
            position: 'mid',
            icon: 'success',
            title: 'Chính xác',
            showConfirmButton: false,
            timer: 1500
            })
      $scope.mark = $scope.mark + 1;
      }else{
        Swal.fire({
            position: 'mid',
            icon: 'error',
            title: 'Sai đáp án!!',
            showConfirmButton: false,
            timer: 1500
            })
      }
    }
  })
  
  app.controller("dangki", function($scope, $rootScope){
    $scope.dangki = function(){
      var student = 
        {
          "username": $scope.username,
          "password": $scope.password,
          "email": $scope.email,
          "fullname": "",
          "gender": "false",
          "birthday": "",
          "schoolfee": "0",
          "marks": "0"
        }
      
      students.push(angular.copy(student));
      alert("Thêm thành công!!");
      console.log(students);
    }
  })

  app.controller("quenmatkhau", function($scope){
    $scope.laymatkhau = function(){
      var pass = 0;
      for(var i= 0; i < students.length; i++){
        var motsv = students[i];
        if(motsv.email == $scope.email){
          pass = motsv.password;
          break;
        }
      }
      if(pass != 0){
      Swal.fire(
        'Tìm thấy!',
        'Mật khẩu của bạn là : ' + pass,
        'success'
      )
      }
      else {
        Swal.fire({
          icon: 'error',
          title: 'Oops...',
          text: 'Không tìm thấy email này!!'
        })
      }
    }
  })

  app.controller("doimatkhau", function($scope){
    $scope.username = sessionStorage.getItem("username");
    $scope.doimatkhau = function(){
      for(var i= 0; i < students.length; i++){
          var motsv = students[i];
          if(motsv.username == $scope.username){
            if(motsv.password == $scope.oldpwd){
              students[i].password = $scope.newpwd;
              alert("Đổi thành công!!");
              console.log(students);
            }
            else{
              alert("Không đúng mật khẩu cũ!!");
            }
            break;
          }
        }
      }
  })

  app.controller("checkDN", function($scope){
    $scope.trangthai = false;
    $scope.tenDN = sessionStorage.getItem("username");
    if($scope.tenDN != null){
      $scope.trangthai = true;
    }
    $scope.dangxuat = function(){
      $scope.trangthai = false;
      delete sessionStorage.username;
      document.location = "trangchu.html"
    }
    $scope.username = sessionStorage.getItem("username");
    $scope.fullname = sessionStorage.getItem("hoten");
    $scope.birthday = sessionStorage.getItem("birthday");
    $scope.email = sessionStorage.getItem("email");
  })

  app.controller("hoso", function($scope){
    
  })
</script>
</html>